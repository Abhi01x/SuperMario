<html>
<head>
<style>
canvas{
	background-image:url("level2.jpg");
}
#platformimage
{
position:relative;
top:65px;
left:-605px;

}
</style>
</head>
<body onload="startGame()">
<audio src="jump.wav" id="audio"></audio>
<audio src="mariodie.wav" id="audio1"></audio>
<script type="text/javascript">
minHeight=20;
maxHeight=100;
minWidth=10;
maxWidth=20;
minGap=200;
maxGap=500;
gap=randGap();
var myObstacles=[];
var colors=["brick","gizmo","turtle","flower","bullet","cloud","indigo","Chocolate"];
var audio=document.getElementById("audio");
var audio1=document.getElementById("audio1");

var gamescore=0;

var pimage=new Image();
pimage.src="walk.png";
var standimage=new Image();
standimage.src="stand.png";

var brickimage=new Image();
brickimage.src="brickenemy2.png";

var pipeimage=new Image();
pipeimage.src="pipe.png";

var gizmoimage=new Image();
gizmoimage.src="gizmoblue.png";

var turtleimage=new Image();
turtleimage.src="turtle.png";

var flowerimage=new Image();
flowerimage.src="plant2.png";

var bulletimage=new Image();
bulletimage.src="bullet.png";

function startGame(){
	gamearea.start();
}
function everyinterval(n){
	if(gamearea.frame%n==0) return true;
	return false;
}
function jump(){
	player.speedY=-2;
	audio.play();
}
function randGap(){
	return Math.floor(minGap+Math.random()*(maxGap-minGap+1));
}
var scoreText={
	x:220,
	y:200,
	update:function(text){
		gamearea.context.fillStyle="white";
		gamearea.context.font="30px Consolas";
		gamearea.context.fillText(text,this.x,this.y);
	}
}
var player={
	x:40,
	y:470,
	speedY:0,
	update:function(){
		gamearea.context.fillStyle="black";
		//gamearea.context.fillRect(this.x,this.y,30,30);
		if(this.y<470)
		{
		gamearea.context.drawImage(pimage,this.x,this.y-40,60,60);
		}
		else
		{
		gamearea.context.drawImage(standimage,this.x,this.y-40,50,60);
		}
		
		
		
	},
	newPos:function(){
		if(this.y<280){
			this.speedY=2;
		}
		this.y=this.y+this.speedY;
		if(this.speedY==2 && this.y==470){
			this.speedY=0;
		}
		
	},
	crashWith:function(obs){
		if(this.x+30>obs.x && this.x<obs.x+obs.width && this.y+30>obs.y){
			return true;
		}
		return false;
	}
}
function obstacle(){
	this.height=Math.floor(minHeight+Math.random()*(maxHeight-minHeight+1));
	this.width=Math.floor(minWidth+Math.random()*(maxWidth-minWidth+1));
	this.x=1000;
	this.y=gamearea.canvas.height-this.height;
	this.index=Math.floor(Math.random()*colors.length);
	this.color=colors[this.index];
	this.draw=function(){
	
		//gamearea.context.fillRect(this.x,this.y,this.width,this.height);
		if(this.color=="brick" ) 
		{
		gamearea.context.drawImage(brickimage,this.x,this.y,40,this.height+5);
		}
		else if(this.color=="flower")
		{
		gamearea.context.drawImage(flowerimage,this.x,440,43,50);
		}
		else if(this.color=="gizmo")
		{
		gamearea.context.drawImage(gizmoimage,this.x,443,43,40);
		}
		else if(this.color=="turtle")
		{
		gamearea.context.drawImage(turtleimage,this.x,450,40,47);
		}
		else if(this.color=="bullet")
		{
		gamearea.context.drawImage(bulletimage,this.x,this.y-50,40,40);
		}
		else
		{
		gamearea.context.drawImage(pipeimage,this.x,this.y,40,this.height);
		}
	}
	}

var gamearea={
	canvas:document.createElement("canvas"),
	start:function(){
		this.canvas.height=500;
		this.canvas.width=600;
		document.body.insertBefore(this.canvas,document.body.childNodes[0]);
		this.context=this.canvas.getContext("2d");
		this.frame=0;
		this.score=0;
		scoreText.update("Score: 0");
		this.interval=setInterval(this.updateGameArea,5);
		window.addEventListener("keydown",jump);
	},
	updateGameArea:function(){
		for(i=0;i<myObstacles.length;i++){
			if(player.crashWith(myObstacles[i])){
				gamearea.stop();
				return;
			}
		}
		gamearea.clear();
		if(everyinterval(gap)){
			myObstacles.push(new obstacle());
			gap=randGap();
			gamearea.frame=0;
		}
		for(i=0;i<myObstacles.length;i++){
			myObstacles[i].x-=1;
			myObstacles[i].draw();
		}
		player.newPos();
		player.update();
		gamearea.frame+=1;
		gamearea.score+=0.01;
		gamescore=Math.floor(gamearea.score);
		scoreText.update("Score: "+gamescore);
	},
	clear:function(){
		gamearea.context.clearRect(0,0,this.canvas.width,this.canvas.width);
	},
	stop:function(){
		clearInterval(this.interval);
		gamearea.context.fillStyle="white";
		gamearea.context.font="30px Consolas";
		
		gamearea.context.fillText("GAME OVER!!!",200,250);
		
		audio1.play();
	}
}

</script>
<img src="platform2.png" id="platformimage"></img>
</body>
</html>